(()=>{"use strict";const e=window.React,{__}=window.wp.i18n,{registerPlugin:t}=window.wp.plugins,{ExperimentalOrderShippingPackages:n,extensionCartUpdate:o}=window.wc.blocksCheckout,{Button:i}=window.wc.blocksCheckout,{getSetting:c}=window.wc.wcSettings,{useSelect:a}=window.wp.data,{PAYMENT_STORE_KEY:r}=window.wc.wcBlocksData,s="furgonetka-pickup-point",p=({cart:t,extensions:n})=>{var p;const l=c(s+"_data")||{},u=l.furgonetka_shipping_rates_configuration||{},d=l.furgonetka_map_api_key||null,w="cod"===a((e=>e(r).getActivePaymentMethod())),g=function(e){const t=e&&e.shippingRates&&e.shippingRates[0]&&e.shippingRates[0].shipping_rates;if(!t)return;const n=t.find((e=>e.selected));if(!n)return;const o=n.rate_id;return u[o]?u[o]:void 0}(t),k=g?.courier_service,_=null!==(p=g?.points_types)&&void 0!==p?p:[];function f(e){var t;let n=null!==(t=e.country)&&void 0!==t?t:"PL";return e&&e.city&&e.address_1?{city:e.city,street:e.address_1,countryCode:n}:{countryCode:n}}if(!t.cartNeedsShipping||!k)return null;const m=w?n.furgonetka.selected_point_cod:n.furgonetka.selected_point,y=Boolean(m.code);return(0,e.createElement)("div",{className:"furgonetka-wc-blocks-pickup-point-block-container"},(0,e.createElement)("p",{className:"furgonetka-wc-blocks-pickup-point-block-button-container"},(0,e.createElement)(i,{onClick:function(){"function"!=typeof window.Furgonetka.Map&&alert(__("There was a problem loading the map. Please try again.","furgonetka"));let e=f(t.shippingAddress)||f(t.billingAddress)||{},n={courierServices:[k],pointTypesFilter:[],mapBounds:"PL"===e.countryCode?"pl":"eu",countryCodesFilter:[e.countryCode],availableServiceTypes:_,apiKey:d};w&&n.pointTypesFilter.push("cod"),new window.Furgonetka.Map({...n,...e,callback:e=>o({namespace:"furgonetka",data:[{action:w?"set_point_cod":"set_point",payload:{service:k,service_type:e.service_type,code:e.code,name:e.name}}]})}).view()}},__(y?"Change point":"Select point","furgonetka"))),y?(0,e.createElement)("p",{className:"furgonetka-wc-blocks-pickup-point-block-label"},m.name," (",m.code,")"):null)};t(s,{render:()=>(0,e.createElement)(n,null,(0,e.createElement)(p,null)),scope:"woocommerce-checkout"})})();